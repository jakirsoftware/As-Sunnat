function doGet() {
  return HtmlService.createHtmlOutputFromFile('index');
}

// Get unique values for Column A from 'Extra'!F2:F
function getUniqueColA() {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('Extra');
  var data = sheet.getRange('F2:F' + sheet.getLastRow()).getValues().flat();
  return [...new Set(data)].filter(String);
}

// Get Column B options based on selected Column A
function getColBOptions(colAValue) {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('Extra');
  var data = sheet.getRange('F2:G' + sheet.getLastRow()).getValues();
  var colBValues = data.filter(row => row[0] === colAValue).map(row => row[1]);
  return [...new Set(colBValues)].filter(String);
}

// Get Column C options based on selected Column B
function getColCOptions(colBValue) {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('Extra');
  var data = sheet.getRange('G2:H' + sheet.getLastRow()).getValues();
  var colCValues = data.filter(row => row[0] === colBValue).map(row => row[1]);
  return [...new Set(colCValues)].filter(String);
}

// Get Column D values (ID) and display labels (Name) from 'Contact'!A2:A (ID) and 'Contact'!B2:B (Label)
function getColDOptions() {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('Contact');
  var data = sheet.getRange('A2:B' + sheet.getLastRow()).getValues();
  var options = data.map(row => ({ id: row[0], label: row[1] }));
  return options.filter(option => option.id && option.label); // Remove empty values
}

// Submit form data to 'E1' sheet
function submitData(colA, colB, colC, colD) {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("E1");
  sheet.appendRow([colA, colB, colC, colD, new Date()]); // Store values with timestamp
  return "Success";
}
----------------------------------------
<!DOCTYPE html>
<html>
<head>
  <title>Data Entry Form</title>
  <script>
    // Load Column A and Column D options on page load
    function loadOptions() {
      google.script.run.withSuccessHandler(function(options) {
        var colA = document.getElementById("colA");
        colA.innerHTML = "<option value=''>Select an option</option>";
        options.forEach(value => {
          var option = document.createElement("option");
          option.value = value;
          option.text = value;
          colA.appendChild(option);
        });
      }).getUniqueColA();

      google.script.run.withSuccessHandler(function(options) {
        var colD = document.getElementById("colD");
        colD.innerHTML = "<option value=''>Select an option</option>";
        options.forEach(option => {
          var opt = document.createElement("option");
          opt.value = option.id;  // Store ID in value
          opt.text = option.label; // Show Name in dropdown
          colD.appendChild(opt);
        });
      }).getColDOptions();
    }

    // Update Column B based on selected Column A
    function updateColB() {
      var colAValue = document.getElementById("colA").value;
      var colB = document.getElementById("colB");
      colB.innerHTML = "<option value=''>Select an option</option>"; // Reset

      if (colAValue) {
        google.script.run.withSuccessHandler(function(options) {
          options.forEach(value => {
            var option = document.createElement("option");
            option.value = value;
            option.text = value;
            colB.appendChild(option);
          });
        }).getColBOptions(colAValue);
      }
      document.getElementById("colC").innerHTML = "<option value=''>Select an option</option>"; // Reset Column C
    }

    // Update Column C based on selected Column B
    function updateColC() {
      var colBValue = document.getElementById("colB").value;
      var colC = document.getElementById("colC");
      colC.innerHTML = "<option value=''>Select an option</option>"; // Reset

      if (colBValue) {
        google.script.run.withSuccessHandler(function(options) {
          options.forEach(value => {
            var option = document.createElement("option");
            option.value = value;
            option.text = value;
            colC.appendChild(option);
          });
        }).getColCOptions(colBValue);
      }
    }

    // Handle form submission and show success message
    function submitForm(event) {
      event.preventDefault(); // Prevent page reload

      var colA = document.getElementById("colA").value;
      var colB = document.getElementById("colB").value;
      var colC = document.getElementById("colC").value;
      var colD = document.getElementById("colD").value;

      if (colA && colB && colC && colD) {
        google.script.run.withSuccessHandler(function(response) {
          document.getElementById("message").innerText = "✅ Form submitted successfully!";
          document.getElementById("form").reset(); // Reset form after submission
        }).submitData(colA, colB, colC, colD);
      } else {
        document.getElementById("message").innerText = "⚠️ Please fill all fields!";
      }
    }

    // Load options when the page loads
    window.onload = loadOptions;
  </script>
</head>
<body>
  <h1>Data Entry Form</h1>
  <form id="form" onsubmit="submitForm(event)">
    
    <label for="colA">Column A:</label><br>
    <select id="colA" name="colA" required onchange="updateColB()">
      <option value="">Loading...</option>
    </select><br><br>

    <label for="colB">Column B:</label><br>
    <select id="colB" name="colB" required onchange="updateColC()">
      <option value="">Select an option</option>
    </select><br><br>

    <label for="colC">Column C:</label><br>
    <select id="colC" name="colC" required>
      <option value="">Select an option</option>
    </select><br><br>

    <label for="colD">Column D (From 'Contact'!A2:A but shows 'Contact'!B2:B):</label><br>
    <select id="colD" name="colD" required>
      <option value="">Loading...</option>
    </select><br><br>

    <input type="submit" value="Submit">
  </form>

  <p id="message" style="font-weight: bold; color: green;"></p> <!-- Success message will appear here -->

</body>
</html>
