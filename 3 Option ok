function doGet() {
  return HtmlService.createHtmlOutputFromFile('index');
}

// Get unique values for Column A from 'Extra'!F2:F
function getUniqueColA() {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('Extra');
  var data = sheet.getRange('F2:F' + sheet.getLastRow()).getValues().flat();
  return [...new Set(data)].filter(String);
}

// Get Column B options based on selected Column A
function getColBOptions(colAValue) {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('Extra');
  var data = sheet.getRange('F2:G' + sheet.getLastRow()).getValues();
  var colBValues = data.filter(row => row[0] === colAValue).map(row => row[1]);
  return [...new Set(colBValues)].filter(String);
}

// Get Column C options based on selected Column B
function getColCOptions(colBValue) {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('Extra');
  var data = sheet.getRange('G2:H' + sheet.getLastRow()).getValues();
  var colCValues = data.filter(row => row[0] === colBValue).map(row => row[1]);
  return [...new Set(colCValues)].filter(String);
}

// Get Column D values (ID) and display labels (Name) from 'Contact'!A2:A (ID) and 'Contact'!B2:B (Label)
function getColDOptions() {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('Contact');
  var data = sheet.getRange('A2:B' + sheet.getLastRow()).getValues();
  var options = data.map(row => ({ id: row[0], label: row[1] }));
  return options.filter(option => option.id && option.label); // Remove empty values
}

// Get Column G options from 'Bank'!A2:A
function getColGOptions() {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('Bank');
  var data = sheet.getRange('A2:B' + sheet.getLastRow()).getValues();
  var options = data.map(row => ({ id: row[0], label: row[1] }));
  return options.filter(option => option.id && option.label); // Remove empty values
}

// Submit form data to 'E1' sheet (Including Column E - Numeric Input, Column F - Numeric Input, and Column G)
function submitData(colA, colB, colC, colD, colE, colF, colG, colH) {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("E1");
  sheet.appendRow([colA, colB, colC, colD, colE, colF, colG, colH, new Date()]); // Store values with timestamp
  return "Success";
}
----------------------------------
<!DOCTYPE html>
<html>
<head>
  <title>Data Entry Form</title>
  <script>
    // Load Column A, Column D, and Column G options on page load
    function loadOptions() {
      google.script.run.withSuccessHandler(function(options) {
        var colA = document.getElementById("colA");
        colA.innerHTML = "<option value=''>Select an option</option>";
        options.forEach(value => {
          var option = document.createElement("option");
          option.value = value;
          option.text = value;
          colA.appendChild(option);
        });
      }).getUniqueColA();

      google.script.run.withSuccessHandler(function(options) {
        var colD = document.getElementById("colD");
        colD.innerHTML = "<option value=''>Select an option</option>";
        options.forEach(option => {
          var opt = document.createElement("option");
          opt.value = option.id;  // Store ID in value
          opt.text = option.label; // Show Name in dropdown
          colD.appendChild(opt);
        });
      }).getColDOptions();

      google.script.run.withSuccessHandler(function(options) {
        var colG = document.getElementById("colG");
        colG.innerHTML = "<option value=''>Select an option</option>";
        options.forEach(option => {
          var opt = document.createElement("option");
          opt.value = option.id;  // Store ID in value
          opt.text = option.label; // Show Name in dropdown
          colG.appendChild(opt);
        });
      }).getColGOptions();
    }

    // Update Column B based on selected Column A
    function updateColB() {
      var colAValue = document.getElementById("colA").value;
      var colB = document.getElementById("colB");
      colB.innerHTML = "<option value=''>Select an option</option>"; // Reset

      if (colAValue) {
        google.script.run.withSuccessHandler(function(options) {
          options.forEach(value => {
            var option = document.createElement("option");
            option.value = value;
            option.text = value;
            colB.appendChild(option);
          });
        }).getColBOptions(colAValue);
      }
      document.getElementById("colC").innerHTML = "<option value=''>Select an option</option>"; // Reset Column C
    }

    // Update Column C based on selected Column B
    function updateColC() {
      var colBValue = document.getElementById("colB").value;
      var colC = document.getElementById("colC");
      colC.innerHTML = "<option value=''>Select an option</option>"; // Reset

      if (colBValue) {
        google.script.run.withSuccessHandler(function(options) {
          options.forEach(value => {
            var option = document.createElement("option");
            option.value = value;
            option.text = value;
            colC.appendChild(option);
          });
        }).getColCOptions(colBValue);
      }
    }

    // Handle form submission and show success message
    function submitForm(event) {
      event.preventDefault(); // Prevent page reload

      var colA = document.getElementById("colA").value;
      var colB = document.getElementById("colB").value;
      var colC = document.getElementById("colC").value;
      var colD = document.getElementById("colD").value;
      var colE = document.getElementById("colE").value; // Get value for Column E
      var colF = document.getElementById("colF").value; // Get value for Column F
      var colG = document.getElementById("colG").value; // Get value for Column G
      var colH = document.getElementById("colH").value; // Get value for Column H

 





function checkColF() {
  var colFValue = parseFloat(document.getElementById("colF").value);
  var colGField = document.getElementById("colG");
  var colGLabel = document.getElementById("colGLabel");

  if (colFValue > 0) {
    colGField.style.display = "block"; // Show Column G
    colGLabel.style.display = "block"; // Show Label
    colGField.required = true; // Make Column G required
  } else {
    colGField.style.display = "none"; // Hide Column G
    colGLabel.style.display = "none"; // Hide Label
    colGField.required = false; // Remove required attribute
    colGField.value = ""; // Reset value if hidden
  }
}













      // Validate all fields
      if (colA && colB && colC && colD && colE) {
        google.script.run.withSuccessHandler(function(response) {
          document.getElementById("message").innerText = "✅ Form submitted successfully!";
          //document.getElementById("form").reset(); // Reset form after submission
          document.getElementById("colC").value = "";
          document.getElementById("colE").value = "";
          document.getElementById("colF").value = "";
          document.getElementById("colG").value = "";
        }).submitData(colA, colB, colC, colD, colE, colF, colG, colH);
      } else {
        document.getElementById("message").innerText = "⚠️ Please fill all fields!";
      }
    }

    // Load options when the page loads
    window.onload = loadOptions;
  </script>
</head>
<body>
  <h1>Data Entry Form</h1>
  <form id="form" onsubmit="submitForm(event)">
    
    <label for="colA">Column A:</label><br>
    <select id="colA" name="colA" required onchange="updateColB()">
      <option value="">Loading...</option>
    </select><br><br>

    <label for="colB">Column B:</label><br>
    <select id="colB" name="colB" required onchange="updateColC()">
      <option value="">Select an option</option>
    </select><br><br>

    <label for="colC">Column C:</label><br>
    <select id="colC" name="colC" required>
      <option value="">Select an option</option>
    </select><br><br>

    <label for="colD">Column D (From 'Contact'!A2:A but shows 'Contact'!B2:B):</label><br>
    <select id="colD" name="colD" required>
      <option value="">Loading...</option>
    </select><br><br>

    <label for="colE">Column E (Numeric Input):</label><br>
    <input type="number" id="colE" name="colE" required><br><br>

    <label for="colF">Column F (Numeric Input):</label><br>
    <input type="number" id="colF" name="colF" ><br><br>

    <label for="colG">Column G (Choose from 'Bank'!A2:A):</label><br>
    <select id="colG" name="colG" required onchange="checkColF()"><br><br>
      <option value="">Loading...</option>
    </select><br><br>



    

    <label for="colH">Column E (text Input):</label><br>
    <input type="text" id="colH" name="colH"><br><br>

    <input type="submit" value="Submit">
  </form>

  <p id="message" style="font-weight: bold; color: green;"></p> <!-- Success message will appear here -->

</body>
</html>
